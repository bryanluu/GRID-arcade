#include "QRScene.h"
#include "Colors.h"
#include "Logging.h"

const uint8_t qr25x25[25][25] = {
    {1,1,1,1,1,1,1,0,1,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1},
    {1,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1},
    {1,0,1,1,1,0,1,0,0,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,1},
    {1,0,1,1,1,0,1,0,0,0,0,0,1,1,0,1,1,0,1,0,1,1,1,0,1},
    {1,0,1,1,1,0,1,0,0,1,0,1,0,1,1,0,0,0,1,0,1,1,1,0,1},
    {1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1},
    {1,1,1,1,1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,1,1,1},
    {0,0,0,0,0,0,0,0,1,0,1,1,0,1,0,0,1,0,0,0,0,0,0,0,0},
    {1,1,0,1,1,0,1,0,0,1,1,1,1,0,1,1,0,0,1,0,0,0,0,0,1},
    {0,1,0,0,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,1,1,1,1,1,0},
    {0,1,1,1,1,1,1,1,0,0,1,1,0,0,0,1,1,1,1,0,0,1,0,0,1},
    {0,1,1,1,1,1,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,1,1,1,1},
    {1,1,0,0,1,1,1,0,1,1,0,0,1,0,0,1,0,0,1,1,0,0,0,0,1},
    {1,0,0,1,1,1,0,1,0,0,0,1,1,0,1,1,1,1,0,0,1,0,0,1,0},
    {1,1,0,0,0,1,1,0,1,1,0,0,0,1,0,1,1,0,0,0,1,1,1,1,1},
    {1,0,0,0,1,0,0,1,1,1,0,1,0,0,1,0,0,1,1,1,0,1,1,0,1},
    {1,0,0,1,1,1,1,1,0,1,1,0,1,1,0,0,1,1,1,1,1,0,1,1,0},
    {0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,1,0,0,0,1,0,1,1,0},
    {1,1,1,1,1,1,1,0,0,0,0,1,0,1,0,0,1,0,1,0,1,0,0,0,1},
    {1,0,0,0,0,0,1,0,0,1,0,0,1,1,0,1,1,0,0,0,1,0,0,1,0},
    {1,0,1,1,1,0,1,0,1,0,1,1,1,0,1,1,1,1,1,1,1,0,0,0,0},
    {1,0,1,1,1,0,1,0,1,0,0,1,0,0,1,0,0,1,1,0,0,0,0,1,1},
    {1,0,1,1,1,0,1,0,0,1,0,1,1,1,1,0,1,1,0,0,1,1,1,1,1},
    {1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,1,1,1,0,1,1,1},
    {1,1,1,1,1,1,1,0,1,1,1,0,1,0,1,0,1,0,1,0,0,1,0,0,1}
};

void QRScene::setup(AppContext &ctx)
{
    const char *url = "https://bryanluu.github.io/";

    const int size = 25; // fixed size for this QR code
    ctx.logger.logf(LogLevel::Info, "QR size: %d x %d", size, size);

    // used for centering the QR
    const int kXOffset = (MATRIX_WIDTH - size) / 2;
    const int kYOffset = (MATRIX_HEIGHT - size) / 2;

    for (int y = 0; y < size; y++)
    {
        for (int x = 0; x < size; x++)
        {
            bool black = qr25x25[y][x] == 1;
            ctx.gfx.setSafe(x + kXOffset, y + kYOffset, black ? Colors::Black : Colors::Muted::White);
        }
    }
}

void QRScene::loop(AppContext &ctx)
{
}
